<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter6 Occupancy analysis, ML method | Occupancy simulation and analysis</title>
  <meta name="description" content="This is an R example to get occupancy data and analize it." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter6 Occupancy analysis, ML method | Occupancy simulation and analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/venado_large.png" />
  <meta property="og:description" content="This is an R example to get occupancy data and analize it." />
  <meta name="github-repo" content="dlizcano/OTS" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter6 Occupancy analysis, ML method | Occupancy simulation and analysis" />
  
  <meta name="twitter:description" content="This is an R example to get occupancy data and analize it." />
  <meta name="twitter:image" content="/images/venado_large.png" />

<meta name="author" content="Diego J. Lizcano, Ph.D." />


<meta name="date" content="2022-06-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="function1.html"/>
<link rel="next" href="bayesian.html"/>
<script src="libs/header-attrs-2.14/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Occupancy simulation and analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#please-cite-this-work-as"><i class="fa fa-check"></i><b>1.1</b> Please cite this work as:<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>2</b> Why to do simulations?<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="why.html"><a href="why.html#why-simulations-are-useful"><i class="fa fa-check"></i><b>2.1</b> why simulations are useful:<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="occu.html"><a href="occu.html"><i class="fa fa-check"></i><b>3</b> The Occupancy<span></span></a></li>
<li class="chapter" data-level="4" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>4</b> Our Example:<span></span></a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="example.html"><a href="example.html#ecological-model"><i class="fa fa-check"></i><b>4.0.1</b> Ecological Model:<span></span></a></li>
<li class="chapter" data-level="4.0.2" data-path="example.html"><a href="example.html#observation-model"><i class="fa fa-check"></i><b>4.0.2</b> Observation Model:<span></span></a></li>
<li class="chapter" data-level="4.1" data-path="example.html"><a href="example.html#initial-steps-sample-size-and-covariate-values"><i class="fa fa-check"></i><b>4.1</b> Initial steps: sample size and covariate values<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="example.html"><a href="example.html#simulating-the-ecological-process-and-its-result-the-occurrence-of-the-tapir"><i class="fa fa-check"></i><b>4.2</b> Simulating the ecological process and its result: the occurrence of The Tapir<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="example.html"><a href="example.html#why-bernoulli"><i class="fa fa-check"></i><b>4.2.1</b> Why Bernoulli?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="example.html"><a href="example.html#simulating-the-observation-process-and-its-result-the-detection"><i class="fa fa-check"></i><b>4.3</b> Simulating the observation process and its result: the detection<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="example.html"><a href="example.html#uniting-the-two-processes-the-ecological-and-the-observation"><i class="fa fa-check"></i><b>4.3.1</b> Uniting the two processes the ecological and the observation<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="function1.html"><a href="function1.html"><i class="fa fa-check"></i><b>5</b> Packing everything into a function<span></span></a></li>
<li class="chapter" data-level="6" data-path="unmarked.html"><a href="unmarked.html"><i class="fa fa-check"></i><b>6</b> Occupancy analysis, ML method<span></span></a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="unmarked.html"><a href="unmarked.html#clearing-r-memory"><i class="fa fa-check"></i><b>6.0.1</b> Clearing R memory<span></span></a></li>
<li class="chapter" data-level="6.1" data-path="unmarked.html"><a href="unmarked.html#generating-the-data"><i class="fa fa-check"></i><b>6.1</b> Generating the data<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="unmarked.html"><a href="unmarked.html#putting-the-data-in-unmarked"><i class="fa fa-check"></i><b>6.2</b> Putting the data in unmarked<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="unmarked.html"><a href="unmarked.html#fitting-the-models"><i class="fa fa-check"></i><b>6.3</b> Fitting the models<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="unmarked.html"><a href="unmarked.html#model-selection"><i class="fa fa-check"></i><b>6.4</b> Model Selection<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="unmarked.html"><a href="unmarked.html#prediction-in-graphs"><i class="fa fa-check"></i><b>6.5</b> Prediction in graphs<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="unmarked.html"><a href="unmarked.html#spatially-explicit-prediction"><i class="fa fa-check"></i><b>6.6</b> Spatially explicit prediction<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>7</b> Análisis Bayesiano<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="bayesian.html"><a href="bayesian.html#generando-los-datos"><i class="fa fa-check"></i><b>7.1</b> Generando los datos<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="bayesian.html"><a href="bayesian.html#comparando-los-valores-reales-y-los-estimados-de-ml-y-bayesiano"><i class="fa fa-check"></i><b>7.2</b> Comparando los valores reales y los estimados de ML y Bayesiano<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="información-de-la-sesión-de-r-y-los-paquetes-usados.html"><a href="información-de-la-sesión-de-r-y-los-paquetes-usados.html"><i class="fa fa-check"></i><b>8</b> Información de la sesión de R y los paquetes usados<span></span></a></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/dlizcano/IntroOccuBook" target="_blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Occupancy simulation and analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unmarked" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter6</span> Occupancy analysis, ML method<a href="unmarked.html#unmarked" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Now that we have understood how the two processes work and interact; the ecological and the observational to produce the occupation data. After generating several data sets, now we only have to analyze them. The most direct and intuitive way is to use the occu function from the unmarked <span class="citation">(<a href="#ref-Fiske2011" role="doc-biblioref">Fiske &amp; Chandler, 2011</a>)</span> package. Later we can use a Bayesian type model in the BUGS language to analyze the same data and in the end compare which of the two estimators, Maximum Likelihood or Bayesian, is closer to the true parameters.</p>
<div id="clearing-r-memory" class="section level3 hasAnchor" number="6.0.1">
<h3><span class="header-section-number">6.0.1</span> Clearing R memory<a href="unmarked.html#clearing-r-memory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we continue, and since we have already generated a large amount of data and models in the previous steps, we are going to clear the memory of R before we begin. We do this with the command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="unmarked.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>Once we have done this we must re-run the code of the function that generates the data that we have created in Chapter <a href="function1.html#function1">5</a>.</p>
<p>After having loaded the function again we must return to</p>
</div>
<div id="generating-the-data" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Generating the data<a href="unmarked.html#generating-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This time we will use a TEAM-type design (<a href="https://www.wildlifeinsights.org/team-network" class="uri">https://www.wildlifeinsights.org/team-network</a>) with 60 sampling sites and 30 repeated visits, which is equivalent to the 30 days that the cameras remain active in the field. Again our species is the white-tailed tapir. For this example we will assume that detection is 0.6, occupancy is 0.8, and the interactions are much simpler with elevation as the only covariate explaining occupancy. However, for detection there is a more complex relationship, assuming that there is a slight interaction between the observation covariates. For observation, elevation and temperature interact with each other. Also, note how elevation influences in opposite directions with a positive sign at elevation for detection and negative for occupancy.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="unmarked.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data generation</span></span>
<span id="cb2-2"><a href="unmarked.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets build a model were elevation explain occupancy and p has interactions</span></span>
<span id="cb2-3"><a href="unmarked.html#cb2-3" aria-hidden="true" tabindex="-1"></a>datos2<span class="ot">&lt;-</span><span class="fu">data.fn</span>(<span class="at">M =</span> <span class="dv">60</span>, <span class="at">J =</span> <span class="dv">30</span>, <span class="at">show.plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-4"><a href="unmarked.html#cb2-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean.occupancy =</span> <span class="fl">0.8</span>, <span class="at">beta1 =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">beta2 =</span> <span class="dv">0</span>, <span class="at">beta3 =</span> <span class="dv">0</span>,  </span>
<span id="cb2-5"><a href="unmarked.html#cb2-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean.detection =</span> <span class="fl">0.6</span>, <span class="at">alpha1 =</span> <span class="dv">2</span>, <span class="at">alpha2 =</span> <span class="dv">1</span>, <span class="at">alpha3 =</span> <span class="fl">1.5</span></span>
<span id="cb2-6"><a href="unmarked.html#cb2-6" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb2-7"><a href="unmarked.html#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="unmarked.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to simulate occupancy measurements replicated at M sites during J occasions.</span></span>
<span id="cb2-9"><a href="unmarked.html#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Population closure is assumed for each site.</span></span>
<span id="cb2-10"><a href="unmarked.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected occurrence may be affected by elevation (elev), </span></span>
<span id="cb2-11"><a href="unmarked.html#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># forest cover (forest) and their interaction.</span></span>
<span id="cb2-12"><a href="unmarked.html#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected detection probability may be affected by elevation, </span></span>
<span id="cb2-13"><a href="unmarked.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature (temp) and their interaction.</span></span>
<span id="cb2-14"><a href="unmarked.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function arguments:</span></span>
<span id="cb2-15"><a href="unmarked.html#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     M: Number of spatial replicates (sites)</span></span>
<span id="cb2-16"><a href="unmarked.html#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     J: Number of temporal replicates (occasions)</span></span>
<span id="cb2-17"><a href="unmarked.html#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     mean.occupancy: Mean occurrence at value 0 of occurrence covariates</span></span>
<span id="cb2-18"><a href="unmarked.html#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     beta1: Main effect of elevation on occurrence</span></span>
<span id="cb2-19"><a href="unmarked.html#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     beta2: Main effect of forest cover on occurrence</span></span>
<span id="cb2-20"><a href="unmarked.html#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     beta3: Interaction effect on occurrence of elevation and forest cover</span></span>
<span id="cb2-21"><a href="unmarked.html#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     mean.detection: Mean detection prob. at value 0 of detection covariates</span></span>
<span id="cb2-22"><a href="unmarked.html#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     alpha1: Main effect of elevation on detection probability</span></span>
<span id="cb2-23"><a href="unmarked.html#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     alpha2: Main effect of temperature on detection probability</span></span>
<span id="cb2-24"><a href="unmarked.html#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     alpha3: Interaction effect on detection of elevation and temperature</span></span>
<span id="cb2-25"><a href="unmarked.html#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     show.plot: if TRUE, plots of the data will be displayed; </span></span>
<span id="cb2-26"><a href="unmarked.html#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#               set to FALSE if you are running simulations.</span></span>
<span id="cb2-27"><a href="unmarked.html#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="unmarked.html#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="unmarked.html#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#To make the objects inside the list directly accessible to R, without having to address </span></span>
<span id="cb2-30"><a href="unmarked.html#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">#them as data$C for instance, you can attach datos2 to the search path.</span></span>
<span id="cb2-31"><a href="unmarked.html#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="unmarked.html#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(datos2)         <span class="co"># Make objects inside of &#39;datos2&#39; accessible directly</span></span>
<span id="cb2-33"><a href="unmarked.html#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="unmarked.html#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Remember to detach the data after use, and in particular before attaching a new data </span></span>
<span id="cb2-35"><a href="unmarked.html#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">#object, because more than one data set attached in the search path will cause confusion.</span></span>
<span id="cb2-36"><a href="unmarked.html#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="unmarked.html#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># detach(datos2)         # Make clean up</span></span></code></pre></div>
</div>
<div id="putting-the-data-in-unmarked" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Putting the data in unmarked<a href="unmarked.html#putting-the-data-in-unmarked" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="http://cran.r-project.org/web/packages/unmarked/index.html">Unmarked</a> is the R package we use to analyze the <span class="citation">(<a href="#ref-Fiske2011" role="doc-biblioref">Fiske &amp; Chandler, 2011</a>)</span> occupancy data. To achieve this we must first prepare the data and collect it in an object of type unmarkedFrame. In this case we use the unmarkedFrameOccu function, which is specific for occupancy analysis of a single season or season. More about unmarked at: <a href="https://sites.google.com/site/unmarkedinfo/home" class="uri">https://sites.google.com/site/unmarkedinfo/home</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="unmarked.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(unmarked)</span>
<span id="cb3-2"><a href="unmarked.html#cb3-2" aria-hidden="true" tabindex="-1"></a>siteCovs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(forest,elev)) <span class="co"># occupancy covariates </span></span>
<span id="cb3-3"><a href="unmarked.html#cb3-3" aria-hidden="true" tabindex="-1"></a>obselev<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rep</span>(elev,J),<span class="at">ncol =</span> J) <span class="co"># make elevation per observation</span></span>
<span id="cb3-4"><a href="unmarked.html#cb3-4" aria-hidden="true" tabindex="-1"></a>obsCovs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">temp=</span> temp,<span class="at">elev=</span>obselev) <span class="co"># detection covariates</span></span>
<span id="cb3-5"><a href="unmarked.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="unmarked.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># umf is the object joining observations (y), occupancy covariates (siteCovs)</span></span>
<span id="cb3-7"><a href="unmarked.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and detection covariates (obsCovs). Note that obsCovs should be a list of </span></span>
<span id="cb3-8"><a href="unmarked.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># matrices or dataframes.</span></span>
<span id="cb3-9"><a href="unmarked.html#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="unmarked.html#cb3-10" aria-hidden="true" tabindex="-1"></a>umf <span class="ot">&lt;-</span> <span class="fu">unmarkedFrameOccu</span>(<span class="at">y =</span> y, <span class="at">siteCovs =</span> siteCovs, <span class="at">obsCovs =</span> obsCovs)</span></code></pre></div>
<p>The unmarked package allows us to graphically see how the data is arranged at the sampling sites with the plot function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="unmarked.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (umf)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:umfplot"></span>
<img src="IntroOccuBook_files/figure-html/umfplot-1.png" alt="Inspección grafica del objeto umf." width="672" />
<p class="caption">
Figure 6.1: Inspección grafica del objeto umf.
</p>
</div>
</div>
<div id="fitting-the-models" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Fitting the models<a href="unmarked.html#fitting-the-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The next step is to fit the models that were required by varying the covariates. This is accomplished with the <a href="http://www.rdocumentation.org/packages/unmarked/versions/0.11-0/topics/occu">occu() function</a>.</p>
<p>Keep in mind that in the model building process your models must have a biological meaning.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="unmarked.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># detection first, occupancy next</span></span>
<span id="cb5-2"><a href="unmarked.html#cb5-2" aria-hidden="true" tabindex="-1"></a>fm0 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span><span class="dv">1</span> <span class="sc">~</span><span class="dv">1</span>, umf) <span class="co"># Null model</span></span>
<span id="cb5-3"><a href="unmarked.html#cb5-3" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> elev <span class="sc">~</span> <span class="dv">1</span>, umf) <span class="co"># elev explaining detection</span></span>
<span id="cb5-4"><a href="unmarked.html#cb5-4" aria-hidden="true" tabindex="-1"></a>fm2 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> elev <span class="sc">~</span> elev, umf) <span class="co"># elev explaining detection and occupancy</span></span>
<span id="cb5-5"><a href="unmarked.html#cb5-5" aria-hidden="true" tabindex="-1"></a>fm3 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> temp <span class="sc">~</span> elev, umf)</span>
<span id="cb5-6"><a href="unmarked.html#cb5-6" aria-hidden="true" tabindex="-1"></a>fm4 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> temp <span class="sc">~</span> forest, umf)</span>
<span id="cb5-7"><a href="unmarked.html#cb5-7" aria-hidden="true" tabindex="-1"></a>fm5 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> elev <span class="sc">+</span> temp <span class="sc">~</span> <span class="dv">1</span>, umf)</span>
<span id="cb5-8"><a href="unmarked.html#cb5-8" aria-hidden="true" tabindex="-1"></a>fm6 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> elev <span class="sc">+</span> temp <span class="sc">+</span> elev<span class="sc">:</span>temp <span class="sc">~</span> <span class="dv">1</span>, umf)</span>
<span id="cb5-9"><a href="unmarked.html#cb5-9" aria-hidden="true" tabindex="-1"></a>fm7 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> elev <span class="sc">+</span> temp <span class="sc">+</span> elev<span class="sc">:</span>temp <span class="sc">~</span> elev, umf)</span>
<span id="cb5-10"><a href="unmarked.html#cb5-10" aria-hidden="true" tabindex="-1"></a>fm8 <span class="ot">&lt;-</span> <span class="fu">occu</span>(<span class="sc">~</span> elev <span class="sc">+</span> temp <span class="sc">+</span> elev<span class="sc">:</span>temp <span class="sc">~</span> forest, umf)</span></code></pre></div>
</div>
<div id="model-selection" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Model Selection<a href="unmarked.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unmarked allows you to perform a model selection procedure to select models based on the Akaike information Criterium (AIC) of each one. So the lowest AIC is the most parsimonious model according to our data <span class="citation">(<a href="#ref-Burnham2004" role="doc-biblioref">Burnham &amp; Anderson, 2004</a>)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="unmarked.html#cb6-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">fitList</span>( <span class="co"># here e put names to the models</span></span>
<span id="cb6-2"><a href="unmarked.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(.)psi(.)&#39;</span>                        <span class="ot">=</span> fm0,</span>
<span id="cb6-3"><a href="unmarked.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(elev)psi(.)&#39;</span>                     <span class="ot">=</span> fm1,</span>
<span id="cb6-4"><a href="unmarked.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(elev)psi(elev)&#39;</span>                  <span class="ot">=</span> fm2,</span>
<span id="cb6-5"><a href="unmarked.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(temp)psi(elev)&#39;</span>                  <span class="ot">=</span> fm3,</span>
<span id="cb6-6"><a href="unmarked.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(temp)psi(forest)&#39;</span>                <span class="ot">=</span> fm4,</span>
<span id="cb6-7"><a href="unmarked.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(temp+elev)psi(.)&#39;</span>                <span class="ot">=</span> fm5,</span>
<span id="cb6-8"><a href="unmarked.html#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(temp+elev+elev:temp)psi(.)&#39;</span>      <span class="ot">=</span> fm6,</span>
<span id="cb6-9"><a href="unmarked.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(temp+elev+elev:temp)psi(elev)&#39;</span>   <span class="ot">=</span> fm7,</span>
<span id="cb6-10"><a href="unmarked.html#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;p(temp+elev+elev:temp)psi(forest)&#39;</span> <span class="ot">=</span> fm8)</span>
<span id="cb6-11"><a href="unmarked.html#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="unmarked.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">modSel</span>(models) <span class="co"># model selection procedure</span></span></code></pre></div>
<pre><code>##                                   nPars     AIC  delta   AICwt cumltvWt
## p(temp+elev+elev:temp)psi(elev)       6 1630.77   0.00 9.2e-01     0.92
## p(temp+elev+elev:temp)psi(.)          5 1636.27   5.49 5.9e-02     0.98
## p(temp+elev+elev:temp)psi(forest)     6 1638.24   7.47 2.2e-02     1.00
## p(temp+elev)psi(.)                    4 1672.55  41.78 7.8e-10     1.00
## p(elev)psi(elev)                      4 1741.34 110.57 9.0e-25     1.00
## p(elev)psi(.)                         3 1746.83 116.06 5.8e-26     1.00
## p(temp)psi(elev)                      4 1898.56 267.79 6.5e-59     1.00
## p(temp)psi(forest)                    4 1906.03 275.26 1.6e-60     1.00
## p(.)psi(.)                            2 1969.25 338.48 2.9e-74     1.00</code></pre>
</div>
<div id="prediction-in-graphs" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Prediction in graphs<a href="unmarked.html#prediction-in-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The model with the lowest AIC can be used to predict expected results according to a new data set. For example, one might ask the expected abundance of deer at a higher elevation site. Predictions are also another way of presenting the results of an analysis. Here we will illustrate what the prediction of <span class="math inline">\(\psi\)</span> and <em>p</em> looks like over the range of covariates studied. Note that we are using standardized covariates. If we were using covariates at their real scale, we would have to take into account that they have to be transformed using the mean and standard deviation.</p>
<p>Before using the model to predict it is a good idea to check the model parameters and their errors, then check graphically that the model fits well with the parboot function, which does a resampling of the model. This plot is interpreted as the model having a good fit, when the mean (dotted line) is between the intervals of the histogram. If the line is too far from the histogram the model might not be good at predicting.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="unmarked.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fm7) <span class="co"># see the model parameters</span></span></code></pre></div>
<pre><code>## 
## Call:
## occu(formula = ~elev + temp + elev:temp ~ elev, data = umf)
## 
## Occupancy (logit-scale):
##             Estimate    SE     z  P(&gt;|z|)
## (Intercept)     1.41 0.366  3.85 0.000117
## elev           -1.63 0.656 -2.48 0.013082
## 
## Detection (logit-scale):
##             Estimate     SE     z  P(&gt;|z|)
## (Intercept)     0.53 0.0698  7.60 3.04e-14
## elev            1.80 0.1277 14.10 3.56e-45
## temp            1.16 0.1209  9.57 1.08e-21
## elev:temp       1.33 0.2211  6.00 1.96e-09
## 
## AIC: 1630.771 
## Number of sites: 60
## optim convergence code: 0
## optim iterations: 31 
## Bootstrap iterations: 0</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="unmarked.html#cb10-1" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">&lt;-</span> <span class="fu">parboot</span>(fm7, <span class="at">nsim=</span><span class="dv">250</span>, <span class="at">report=</span><span class="dv">10</span>) <span class="co"># goodness of fit</span></span></code></pre></div>
<pre><code>## t0 = 409.3793</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="unmarked.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (pb) <span class="co"># plot goodness of fit</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fit1"></span>
<img src="IntroOccuBook_files/figure-html/fit1-1.png" alt="Graphical evaluation of the model fit fm7." width="672" />
<p class="caption">
Figure 6.2: Graphical evaluation of the model fit fm7.
</p>
</div>
<p>Now that we know that our best model has a good fit, we can use it to predict occupancy in the altitude range to see how it behaves on a graph.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="unmarked.html#cb13-1" aria-hidden="true" tabindex="-1"></a>elevrange<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">elev=</span><span class="fu">seq</span>(<span class="fu">min</span>(datos2<span class="sc">$</span>elev),<span class="fu">max</span>(datos2<span class="sc">$</span>elev),<span class="at">length=</span><span class="dv">100</span>)) <span class="co"># newdata</span></span>
<span id="cb13-2"><a href="unmarked.html#cb13-2" aria-hidden="true" tabindex="-1"></a>pred_psi <span class="ot">&lt;-</span><span class="fu">predict</span>(fm7,<span class="at">type=</span><span class="st">&quot;state&quot;</span>,<span class="at">newdata=</span>elevrange,<span class="at">appendData=</span><span class="cn">TRUE</span>) </span>
<span id="cb13-3"><a href="unmarked.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Predicted<span class="sc">~</span>elev, pred_psi,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,</span>
<span id="cb13-4"><a href="unmarked.html#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;elev&quot;</span>,</span>
<span id="cb13-5"><a href="unmarked.html#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&quot;psi&quot;</span>)</span>
<span id="cb13-6"><a href="unmarked.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lower<span class="sc">~</span>elev, pred_psi,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="fu">gray</span>(<span class="fl">0.5</span>))</span>
<span id="cb13-7"><a href="unmarked.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(upper<span class="sc">~</span>elev, pred_psi,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="fu">gray</span>(<span class="fl">0.5</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:gpsi"></span>
<img src="IntroOccuBook_files/figure-html/gpsi-1.png" alt="Plot of occupancy versus elevation." width="672" />
<p class="caption">
Figure 6.3: Plot of occupancy versus elevation.
</p>
</div>
</div>
<div id="spatially-explicit-prediction" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Spatially explicit prediction<a href="unmarked.html#spatially-explicit-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also use the best model to predict spatially explicitly if we have the maps. As an illustration we will construct simulated maps for each of our covariates. The maps arise from a random pattern of points with a Poisson distribution. We then convert these points to an interpolated surface.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="unmarked.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lets make random maps for the three covariates</span></span>
<span id="cb14-2"><a href="unmarked.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb14-3"><a href="unmarked.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb14-4"><a href="unmarked.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24</span>) <span class="co"># Remove for random simulations</span></span>
<span id="cb14-5"><a href="unmarked.html#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="unmarked.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># CONSTRUCT ANALYSIS WINDOW USING THE FOLLOWING:</span></span>
<span id="cb14-7"><a href="unmarked.html#cb14-7" aria-hidden="true" tabindex="-1"></a>xrange<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">1002.5</span>)</span>
<span id="cb14-8"><a href="unmarked.html#cb14-8" aria-hidden="true" tabindex="-1"></a>yrange<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">502.5</span>)</span>
<span id="cb14-9"><a href="unmarked.html#cb14-9" aria-hidden="true" tabindex="-1"></a>window<span class="ot">&lt;-</span><span class="fu">owin</span>(xrange, yrange)</span>
<span id="cb14-10"><a href="unmarked.html#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="unmarked.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Build maps from random points and interpole in same line</span></span>
<span id="cb14-12"><a href="unmarked.html#cb14-12" aria-hidden="true" tabindex="-1"></a>elev   <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">rpoispp</span>(<span class="at">lambda=</span><span class="fl">0.6</span>, <span class="at">win=</span>window)) <span class="co"># </span></span>
<span id="cb14-13"><a href="unmarked.html#cb14-13" aria-hidden="true" tabindex="-1"></a>forest <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">rpoispp</span>(<span class="at">lambda=</span><span class="fl">0.2</span>, <span class="at">win=</span>window)) <span class="co"># </span></span>
<span id="cb14-14"><a href="unmarked.html#cb14-14" aria-hidden="true" tabindex="-1"></a>temp   <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">rpoispp</span>(<span class="at">lambda=</span><span class="fl">0.5</span>, <span class="at">win=</span>window)) <span class="co"># </span></span>
<span id="cb14-15"><a href="unmarked.html#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="unmarked.html#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert covs to raster and Put in the same stack </span></span>
<span id="cb14-17"><a href="unmarked.html#cb14-17" aria-hidden="true" tabindex="-1"></a>mapdata.m<span class="ot">&lt;-</span><span class="fu">stack</span>(<span class="fu">raster</span>(elev),<span class="fu">raster</span>(forest), <span class="fu">raster</span>(temp)) </span>
<span id="cb14-18"><a href="unmarked.html#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mapdata.m)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;elev&quot;</span>, <span class="st">&quot;forest&quot;</span>, <span class="st">&quot;temp&quot;</span>) <span class="co"># put names to raster</span></span>
<span id="cb14-19"><a href="unmarked.html#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="unmarked.html#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># lets plot the covs maps</span></span>
<span id="cb14-21"><a href="unmarked.html#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mapdata.m)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:spat"></span>
<img src="IntroOccuBook_files/figure-html/spat-1.png" alt="Simulated map of elevation, forest and temperature." width="672" />
<p class="caption">
Figure 6.4: Simulated map of elevation, forest and temperature.
</p>
</div>
<p>Once we have our covariate maps, we use them to predict with the best model. In this way we can have a map with predictions of the occupancy and the probability of detection.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="unmarked.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the predictions </span></span>
<span id="cb15-2"><a href="unmarked.html#cb15-2" aria-hidden="true" tabindex="-1"></a>predictions_psi <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm7, <span class="at">type=</span><span class="st">&quot;state&quot;</span>, <span class="at">newdata=</span>mapdata.m) <span class="co"># predict psi</span></span></code></pre></div>
<pre><code>##   doing row 1000 of 16384 
##   doing row 2000 of 16384 
##   doing row 3000 of 16384 
##   doing row 4000 of 16384 
##   doing row 5000 of 16384 
##   doing row 6000 of 16384 
##   doing row 7000 of 16384 
##   doing row 8000 of 16384 
##   doing row 9000 of 16384 
##   doing row 10000 of 16384 
##   doing row 11000 of 16384 
##   doing row 12000 of 16384 
##   doing row 13000 of 16384 
##   doing row 14000 of 16384 
##   doing row 15000 of 16384 
##   doing row 16000 of 16384</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="unmarked.html#cb17-1" aria-hidden="true" tabindex="-1"></a>predictions_p   <span class="ot">&lt;-</span> <span class="fu">predict</span>(fm7, <span class="at">type=</span><span class="st">&quot;det&quot;</span>,   <span class="at">newdata=</span>mapdata.m) <span class="co"># predict p</span></span></code></pre></div>
<pre><code>##   doing row 1000 of 16384 
##   doing row 2000 of 16384 
##   doing row 3000 of 16384 
##   doing row 4000 of 16384 
##   doing row 5000 of 16384 
##   doing row 6000 of 16384 
##   doing row 7000 of 16384 
##   doing row 8000 of 16384 
##   doing row 9000 of 16384 
##   doing row 10000 of 16384 
##   doing row 11000 of 16384 
##   doing row 12000 of 16384 
##   doing row 13000 of 16384 
##   doing row 14000 of 16384 
##   doing row 15000 of 16384 
##   doing row 16000 of 16384</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="unmarked.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put in the same stack</span></span>
<span id="cb19-2"><a href="unmarked.html#cb19-2" aria-hidden="true" tabindex="-1"></a>predmaps<span class="ot">&lt;-</span><span class="fu">stack</span>(predictions_psi<span class="sc">$</span>Predicted,predictions_p<span class="sc">$</span>Predicted) </span>
<span id="cb19-3"><a href="unmarked.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(predmaps)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;psi_predicted&quot;</span>, <span class="st">&quot;p_predicted&quot;</span>) <span class="co"># put names</span></span>
<span id="cb19-4"><a href="unmarked.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predmaps)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:spatr"></span>
<img src="IntroOccuBook_files/figure-html/spatr-1.png" alt="Spatially explicit detection and occupancy models." width="672" />
<p class="caption">
Figure 6.5: Spatially explicit detection and occupancy models.
</p>
</div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Burnham2004" class="csl-entry">
Burnham, K. P., &amp; Anderson, D. R. (2004). <span class="nocase">Information and likelihood theory: A basis for model selection and inference</span>. In K. P. Burnham &amp; D. R. Anderson (Eds.), <em>Model selection and multimodel inference: A practical information-theoretic approach</em> (pp. 49–97). New York: Springer New York. Retrieved from <a href="http://link.springer.com/chapter/10.1007%2F978-0-387-22456-5_2">http://link.springer.com/chapter/10.1007%2F978-0-387-22456-5_2</a>
</div>
<div id="ref-Fiske2011" class="csl-entry">
Fiske, I., &amp; Chandler, R. (2011). <span class="nocase">unmarked : An R Package for fitting hierarchical models of wildlife occurrence and abundance</span>. <em>Journal of Statistical Software</em>, <em>43</em>(10), 1–23. doi: <a href="https://doi.org/10.18637/jss.v043.i10">10.18637/jss.v043.i10</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="function1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dlizcano/IntroOccuBook/edit/master/06-unmarked.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IntroOccuBook.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
